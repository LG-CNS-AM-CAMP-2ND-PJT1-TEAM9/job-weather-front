import React, { useState, useEffect } from "react"; // useEffect Ï∂îÍ∞Ä import
import styles from './job_search.module.css';

const JobSearch = () => {
    // ÏßÄÏó≠ Îç∞Ïù¥ÌÑ∞ Î∞è ÏÉÅÌÉú
    const [locations, setLocations] = useState([]);
    const [selectedLocation, setSelectedLocation] = useState(null);
    const [isLocationFilterOpen, setIsLocationFilterOpen] = useState(false);

    // Í≤ΩÎ†• Îç∞Ïù¥ÌÑ∞ Î∞è ÏÉÅÌÉú Ï∂îÍ∞Ä
    const [experiences, setExperiences] = useState([]);
    const [selectedExperience, setSelectedExperience] = useState(null);
    const [isExperienceFilterOpen, setIsExperienceFilterOpen] = useState(false);

    // Í∑ºÎ¨¥ÌòïÌÉú Îç∞Ïù¥ÌÑ∞ Î∞è ÏÉÅÌÉú Ï∂îÍ∞Ä
    const [employmentTypes, setEmploymentTypes] = useState([]);
    const [selectedEmploymentType, setSelectedEmploymentType] = useState(null);
    const [isEmploymentTypeOpen, setIsEmploymentTypeOpen] = useState(false);

    useEffect(() => {
        
        // ÏßÄÏó≠ ÏûÑÏãú Îç∞Ïù¥ÌÑ∞
        const dummyLocations = [
            { id: 'loc-seoul', name: 'ÏÑúÏö∏' },
            { id: 'loc-gyeongi', name: 'Í≤ΩÍ∏∞' },
            { id: 'loc-incheon', name: 'Ïù∏Ï≤ú' },
            { id: 'loc-jeju', name: 'Ï†úÏ£º' },
        ];
        setLocations(dummyLocations);

        // Í≤ΩÎ†• ÏûÑÏãú Îç∞Ïù¥ÌÑ∞
        const dummyExperiences = [
            { id: 'exp-new', name: 'Ïã†ÏûÖ' },
            { id: 'exp-career', name: 'Í≤ΩÎ†•' },
            { id: 'exp-none', name: 'Í≤ΩÎ†•Î¨¥Í¥Ä' },
        ];
        setExperiences(dummyExperiences);

        // Í∑ºÎ¨¥ÌòïÌÉú ÏûÑÏãú Îç∞Ïù¥ÌÑ∞
        const dummyEmploymentTypes = [
            { id: 'type-fulltime', name: 'Ï†ïÍ∑úÏßÅ' },
            { id: 'type-contract', name: 'Í≥ÑÏïΩÏßÅ' },
            { id: 'type-intern', name: 'Ïù∏ÌÑ¥' },
        ];
        setEmploymentTypes(dummyEmploymentTypes);
    }, []);

    // ÌïÑÌÑ∞ ÌÅ¥Î¶≠ Ìï∏Îì§Îü¨ Ìï®ÏàòÎì§
    const handleLocationFilterClick = () => {
        setIsLocationFilterOpen(!isLocationFilterOpen);
        setIsExperienceFilterOpen(false);
        setIsEmploymentTypeOpen(false);
    };

    const handleExperienceFilterClick = () => {
        setIsExperienceFilterOpen(!isExperienceFilterOpen);
        setIsLocationFilterOpen(false);
        setIsEmploymentTypeOpen(false);
    };

    const handleEmploymentTypeClick = () => {
        setIsEmploymentTypeOpen(!isEmploymentTypeOpen);
        setIsLocationFilterOpen(false);
        setIsExperienceFilterOpen(false);
    };

    const handleLocationChange = (event) => {
        setSelectedLocation(event.target.value);
    };

    const handleExperienceChange = (event) => {
        setSelectedExperience(event.target.value);
    };

    const handleEmploymentTypeChange = (event) => {
        setSelectedEmploymentType(event.target.value);
    };

    return (
        <>
            <div className={styles['job-search-bar']}>
                <input type="text" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî." />
            </div>

            <div className={styles['job-filters']}>
                <div className={`${styles['job-filter-box']} ${isLocationFilterOpen ? styles.open : ''}`}>
                    <div
                        onClick={handleLocationFilterClick}
                        style={{ cursor: 'pointer', width: '100%', textAlign: 'center' }}
                    >
                        ÏßÄÏó≠Î≥Ñ
                    </div>
                    {isLocationFilterOpen && (
                        <div className={styles['location-options']}>
                            {locations.map(location => (
                                <div key={location.id} className={styles['filter-option-item']}>
                                    <input
                                        type="radio"
                                        id={location.id}
                                        name="location"
                                        value={location.name}
                                        checked={selectedLocation === location.name}
                                        onChange={handleLocationChange}
                                    />
                                    <label htmlFor={location.id} className={styles['filter-option-label']}>
                                        {location.name}
                                    </label>
                                </div>
                            ))}
                        </div>
                    )}
                </div>

                <div className={`${styles['job-filter-box']} ${isExperienceFilterOpen ? styles.open : ''}`}>
                     <div
                        onClick={handleExperienceFilterClick}
                        style={{ cursor: 'pointer', width: '100%', textAlign: 'center' }}
                    >
                        Í≤ΩÎ†•Î≥Ñ
                    </div>
                    {isExperienceFilterOpen && (
                        <div className={styles['experience-options']}>
                             {experiences.map(experience => (
                                <div key={experience.id} className={styles['filter-option-item']}>
                                    <input
                                        type="radio"
                                        id={experience.id}
                                        name="experience"
                                        value={experience.name}
                                        checked={selectedExperience === experience.name}
                                        onChange={handleExperienceChange}
                                    />
                                    <label htmlFor={experience.id} className={styles['filter-option-label']}>
                                        {experience.name}
                                    </label>
                                </div>
                            ))}
                        </div>
                    )}
                </div>

                <div className={`${styles['job-filter-box']} ${isEmploymentTypeOpen ? styles.open : ''}`}>
                    <div
                        onClick={handleEmploymentTypeClick}
                        style={{ cursor: 'pointer', width: '100%', textAlign: 'center' }}
                    >
                        Í∑ºÎ¨¥ÌòïÌÉú
                    </div>
                     {isEmploymentTypeOpen && (
                        <div className={styles['employment-type-options']}>
                             {employmentTypes.map(type => (
                                <div key={type.id} className={styles['filter-option-item']}>
                                    <input
                                        type="radio"
                                        id={type.id}
                                        name="employmentType"
                                        value={type.name}
                                        checked={selectedEmploymentType === type.name}
                                        onChange={handleEmploymentTypeChange}
                                    />
                                    <label htmlFor={type.id} className={styles['filter-option-label']}>
                                        {type.name}
                                    </label>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            </div>

            <div className={styles['job-listing']}>
                <div className={styles['job-title']}>Ïï±/Ïõπ ÏÑúÎπÑÏä§Í∏∞Ìöç PM [Ïã†ÏûÖ~3ÎÖÑ/Ï†úÏ£º]</div>
                <div>(Ï£º)ÏïÑÏù¥ÏπòÎπÑÏó†Ìîº</div>
                <div className={styles['job-meta']}>
                    <span className={styles['job-location']}>üìçÏ†úÏ£ºÏ†ÑÏ≤¥</span>
                    <span className={styles.separator}>&nbsp;|&nbsp;</span>
                    <span className={styles['job-experience']}>Ïã†ÏûÖ/Í≤ΩÎ†•</span>
                    <span className={styles.separator}>&nbsp;|&nbsp;</span>
                    <span className={styles['job-education']}>Í≥†Ï°∏ ‚Üë</span>
                </div>
                <div className={styles.bookmark}>‚òÜ</div>
            </div>
        </>
    );
};

export default JobSearch;

/* 

import React, { useState, useEffect } from "react";
import styles from './job_search.module.css';

const JobSearch = () => {
    // Ï±ÑÏö© Í≥µÍ≥† Î™©Î°ù ÏÉÅÌÉú Ï∂îÍ∞Ä
    const [jobList, setJobList] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);


    // Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
    useEffect(() => {
        const fetchJobData = async () => {
            try {
                const response = await fetch('Ïó¨Í∏∞Ïóê ÎÇ¥ api');

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const xmlText = await response.text();

                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, "application/xml");

                const jobsXml = xmlDoc.querySelectorAll('job');

                const parsedJobs = Array.from(jobsXml).map(jobElement => {
                    const titleElement = jobElement.querySelector('position > title');
                    const companyNameElement = jobElement.querySelector('company > name');
                    const locationElement = jobElement.querySelector('position > location');
                    const experienceElement = jobElement.querySelector('position > experience-level');
                    const educationElement = jobElement.querySelector('position > required-education-level');
                    const urlElement = jobElement.querySelector('url');

                    return {
                        id: jobElement.querySelector('id')?.textContent || 'N/A',
                        title: titleElement?.textContent.trim() || 'Ï†úÎ™© Ï†ïÎ≥¥ ÏóÜÏùå',
                        companyName: companyNameElement?.textContent.trim() || 'ÌöåÏÇ¨ Ï†ïÎ≥¥ ÏóÜÏùå',
                        location: locationElement?.textContent.trim() || 'ÏßÄÏó≠ Ï†ïÎ≥¥ ÏóÜÏùå',
                        experience: experienceElement?.textContent.trim() || 'Í≤ΩÎ†• Ï†ïÎ≥¥ ÏóÜÏùå',
                        education: educationElement?.textContent.trim() || 'ÌïôÎ†• Ï†ïÎ≥¥ ÏóÜÏùå',
                        url: urlElement?.textContent.trim() || '#',

                        // ÌïÑÏöîÌïòÎ©¥ Îã§Î•∏ Ï†ïÎ≥¥Îì§ÎèÑ Ï∂îÏ∂úÌïòÍ∏∞
                    };
                });

                setJobList(parsedJobs);
                setLoading(false); // Î°úÎî© ÏôÑÎ£å
            } catch (error) {
                console.error("Ï±ÑÏö© Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§Îäî Ï§ë Ïò§Î•ò Î∞úÏÉù:", error);
                setError(error); // Ïò§Î•ò ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                setLoading(false); // Î°úÎî© ÏôÑÎ£å (Ïò§Î•ò Î∞úÏÉù Ïãú)
            }
        };

        fetchJobData();

    }, []);

    return (
        <>
             <div className={styles['job-search-bar']}>
                <input type="text" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî." />
            </div>

            <div className={styles['job-filters']}>
                <div className={`${styles['job-filter-box']} ${isLocationFilterOpen ? styles.open : ''}`}>
                    <div
                        onClick={handleLocationFilterClick}
                        style={{ cursor: 'pointer', width: '100%', textAlign: 'center' }}
                    >
                        ÏßÄÏó≠Î≥Ñ
                    </div>
                    {isLocationFilterOpen && (
                        <div className={styles['location-options']}>
                            {locations.map(location => (
                                <div key={location.id} className={styles['filter-option-item']}>
                                    <input
                                        type="radio"
                                        id={location.id}
                                        name="location"
                                        value={location.name}
                                        checked={selectedLocation === location.name}
                                        onChange={handleLocationChange}
                                    />
                                    <label htmlFor={location.id} className={styles['filter-option-label']}>
                                        {location.name}
                                    </label>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
                <div className={`${styles['job-filter-box']} ${isExperienceFilterOpen ? styles.open : ''}`}>
                     <div
                        onClick={handleExperienceFilterClick}
                        style={{ cursor: 'pointer', width: '100%', textAlign: 'center' }}
                    >
                        Í≤ΩÎ†•Î≥Ñ
                    </div>
                    {isExperienceFilterOpen && (
                        <div className={styles['experience-options']}>
                             {experiences.map(experience => (
                                <div key={experience.id} className={styles['filter-option-item']}>
                                    <input
                                        type="radio"
                                        id={experience.id}
                                        name="experience"
                                        value={experience.name}
                                        checked={selectedExperience === experience.name}
                                        onChange={handleExperienceChange}
                                    />
                                    <label htmlFor={experience.id} className={styles['filter-option-label']}>
                                        {experience.name}
                                    </label>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
                <div className={`${styles['job-filter-box']} ${isEmploymentTypeOpen ? styles.open : ''}`}>
                    <div
                        onClick={handleEmploymentTypeClick}
                        style={{ cursor: 'pointer', width: '100%', textAlign: 'center' }}
                    >
                        Í∑ºÎ¨¥ÌòïÌÉú
                    </div>
                     {isEmploymentTypeOpen && (
                        <div className={styles['employment-type-options']}>
                             {employmentTypes.map(type => (
                                <div key={type.id} className={styles['filter-option-item']}>
                                    <input
                                        type="radio"
                                        id={type.id}
                                        name="employmentType"
                                        value={type.name}
                                        checked={selectedEmploymentType === type.name}
                                        onChange={handleEmploymentTypeChange}
                                    />
                                    <label htmlFor={type.id} className={styles['filter-option-label']}>
                                        {type.name}
                                    </label>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            </div>

            {loading && <p>Ï±ÑÏö© Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</p>}
            {error && <p>Ï±ÑÏö© Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§: {error.message}</p>}
            {!loading && !error && jobList.length === 0 && <p>Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>}

            
            {!loading && !error && jobList.map(job => (
                 <div key={job.id} className={styles['job-listing']}>
                    <div className={styles['job-title']}>{job.title}</div>
                    <div>{job.companyName}</div>
                    <div className={styles['job-meta']}>
                        <span className={styles['job-location']}>üìç{job.location}</span>
                        <span className={styles.separator}>&nbsp;|&nbsp;</span>
                        <span className={styles['job-experience']}>{job.experience}</span>
                        <span className={styles.separator}>&nbsp;|&nbsp;</span>
                        <span className={styles['job-education']}>{job.education}</span>
                    </div>
                    <div className={styles.bookmark}>‚òÜ</div>
                </div>
            ))}

        </>
    );
};

export default JobSearch;


*/